<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Our Valentine's Day</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Mali:wght@400;600&family=Prompt:wght@300;400;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css">

    <style>
        /* --- Styles ‡πÄ‡∏î‡∏¥‡∏° --- */
        :root { --bg-color-1: #ff9a9e; --bg-color-2: #fad0c4; --bg-color-3: #ffd1ff; --primary-color: #ff4d6d; }
        body { font-family: 'Prompt', sans-serif; background: linear-gradient(135deg, var(--bg-color-1), var(--bg-color-2), var(--bg-color-3)); background-size: 400% 400%; animation: gradientMove 15s ease infinite; min-height: 100vh; color: #5a5a5a; overflow-x: hidden; -webkit-tap-highlight-color: transparent; user-select: none; }
        @keyframes gradientMove { 0% { background-position: 0% 50%; } 50% { background-position: 100% 50%; } 100% { background-position: 0% 50%; } }
        
        .hearts-container { position: fixed; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 0; overflow: hidden; }
        .heart-float { position: absolute; width: 20px; height: 20px; background: rgba(255, 255, 255, 0.5); transform: rotate(45deg); animation: floatUp linear infinite; bottom: -10vh; }
        .heart-float::before, .heart-float::after { content: ""; position: absolute; width: 20px; height: 20px; background: inherit; border-radius: 50%; }
        .heart-float::before { left: -10px; top: 0; } .heart-float::after { left: 0; top: -10px; }
        @keyframes floatUp { 0% { transform: translateY(0) rotate(45deg); opacity: 0; } 20% { opacity: 0.8; } 100% { transform: translateY(-120vh) rotate(45deg); opacity: 0; } }

        .section-page { position: relative; z-index: 10; display: none; padding: 60px 20px 40px 20px; animation: fadeIn 0.5s ease-out; min-height: 100vh; }
        .active-section { display: block; }
        .glass-card { background: rgba(255, 255, 255, 0.75); backdrop-filter: blur(16px); -webkit-backdrop-filter: blur(16px); border-radius: 24px; border: 1px solid rgba(255, 255, 255, 0.6); box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1); padding: 30px; }
        .btn-main { background: linear-gradient(45deg, #ff758c, #ff7eb3); border: none; color: white; padding: 14px 35px; border-radius: 50px; font-size: 1.1rem; font-weight: 600; box-shadow: 0 4px 15px rgba(255, 117, 140, 0.4); transition: transform 0.1s; }
        .btn-main:active { transform: scale(0.92); }
        .btn-back-pill { position: fixed; top: 20px; left: 20px; z-index: 1000; background: rgba(255, 255, 255, 0.65); backdrop-filter: blur(10px); -webkit-backdrop-filter: blur(10px); border: 1px solid rgba(255, 255, 255, 0.5); padding: 8px 20px; border-radius: 50px; color: #ff4d6d; font-weight: 600; font-size: 0.95rem; box-shadow: 0 4px 10px rgba(0,0,0,0.05); display: flex; align-items: center; gap: 8px; transition: all 0.2s; cursor: pointer; }
        .hidden { display: none !important; }

        .menu-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px; max-width: 500px; margin: 0 auto; }
        .menu-item { background: rgba(255,255,255,0.85); border-radius: 20px; aspect-ratio: 1/1; display: flex; flex-direction: column; justify-content: center; align-items: center; cursor: pointer; transition: transform 0.1s; box-shadow: 0 4px 10px rgba(0,0,0,0.05); }
        .menu-item:active { transform: scale(0.92); background: white; }
        .menu-item i { font-size: 2rem; color: var(--primary-color); margin-bottom: 8px; }
        .menu-item span { font-size: 0.8rem; font-weight: 600; color: #555; line-height: 1.2; }

        .pin-dot-container { display: flex; justify-content: center; gap: 15px; margin-bottom: 30px; }
        .pin-dot { width: 16px; height: 16px; border-radius: 50%; border: 2px solid var(--primary-color); background: rgba(255,255,255,0.4); transition: background 0.2s; }
        .pin-dot.filled { background: var(--primary-color); }
        .pin-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 15px; max-width: 300px; margin: 0 auto; }
        .pin-btn { width: 75px; height: 75px; border-radius: 50%; background: rgba(255,255,255,0.8); border: none; font-size: 1.6rem; color: #444; margin: 0 auto; box-shadow: 0 4px 6px rgba(0,0,0,0.05); transition: background 0.1s, transform 0.1s; }
        .pin-btn:active { background: var(--primary-color); color: white; transform: scale(0.9); }

        .polaroid-frame { background: white; padding: 15px 15px 50px 15px; border-radius: 4px; box-shadow: 0 10px 30px rgba(0,0,0,0.15); transform: rotate(-2deg); transition: transform 0.3s; margin: 0 auto; max-width: 600px; }
        .polaroid-img { height: 50vh; min-height: 400px; object-fit: cover; width: 100%; border-radius: 2px; border: 1px solid #eee; background: #000; }
        .polaroid-caption { font-family: 'Mali', cursive; text-align: center; margin-top: 15px; color: #555; font-size: 1.2rem; }

        .quiz-step { display: none; animation: slideIn 0.4s ease-out; }
        .quiz-step.active { display: block; }
        .quiz-opt { width: 100%; text-align: left; margin-bottom: 12px; padding: 18px; border-radius: 16px; border: 1px solid rgba(255,255,255,0.5); background: rgba(255,255,255,0.9); font-size: 1.1rem; transition: transform 0.1s; }
        .quiz-opt.correct { background: #d4edda; border-color: #c3e6cb; color: #155724; }
        .quiz-opt.wrong { background: #f8d7da; border-color: #f5c6cb; color: #721c24; }

        .coupon-ticket { background: radial-gradient(circle at left, transparent 10px, white 11px), radial-gradient(circle at right, transparent 10px, white 11px); background-size: 51% 100%; background-position: left, right; background-repeat: no-repeat; filter: drop-shadow(0 4px 6px rgba(0,0,0,0.1)); padding: 30px; margin: 20px auto; max-width: 350px; text-align: center; position: relative; animation: pop 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275); }
        .coupon-inner { border: 2px dashed #ff8fa3; padding: 20px; border-radius: 10px; }
        
        .letter-paper { font-family: 'Mali', cursive; background: #fffdf0; padding: 30px; border-radius: 5px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); line-height: 2; min-height: 400px; }
        .vinyl-record { width: 250px; height: 250px; background: #111; border-radius: 50%; margin: 0 auto 30px; display: flex; align-items: center; justify-content: center; box-shadow: 0 10px 30px rgba(0,0,0,0.3); border: 5px solid #333; }
        .vinyl-inner { width: 100px; height: 100px; background: url('images/cover.jpg') center/cover no-repeat, #ff758c; border-radius: 50%; border: 4px solid white; }
        .spinning { animation: spin 4s linear infinite; }
        .time-box { display: inline-block; padding: 12px; margin: 4px; background: rgba(255,255,255,0.9); border-radius: 12px; min-width: 65px; }
        .time-val { font-size: 1.8rem; font-weight: bold; color: #ff758c; line-height: 1; }
        /* This ensures the image scales down to fit the frame */
        .carousel-item img {
            max-width: 100%;
            max-height: 80vh; /* Limits height so it doesn't overflow the screen */
            object-fit: contain; /* Shows the WHOLE image, adds letterboxing if needed */
            margin: auto;
            display: block;
        }
        /* Adjust the container to wrap around the image properly */
        .carousel-inner {
            display: flex;
            align-items: center;
            background-color: #fff; /* Traditional Polaroid white */
            padding: 20px 20px 60px 20px; /* Thicker bottom for that Polaroid 'label' look */
            box-shadow: 0 4px 10px rgba(0,0,0,0.2);
        }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
        @keyframes slideIn { from { opacity: 0; transform: translateX(30px); } to { opacity: 1; transform: translateX(0); } }
        @keyframes spin { 100% { transform: rotate(360deg); } }
        @keyframes pop { 0% { transform: scale(0.5); opacity:0; } 100% { transform: scale(1); opacity:1; } }
        .filter-black { filter: invert(0.8); }
    </style>
</head>
<body>

    <div class="hearts-container" id="heartsContainer"></div>

    <div id="backBtn" class="btn-back-pill hidden" onclick="playSound(); goToPage('page-menu')">
        <i class="bi bi-chevron-left"></i> ‡πÄ‡∏°‡∏ô‡∏π‡∏´‡∏•‡∏±‡∏Å
    </div>

    <section id="page-landing" class="section-page active-section">
        <div class="d-flex flex-column justify-content-center align-items-center" style="height: 80vh;">
            <div class="glass-card text-center p-5" style="animation: pop 1.5s ease;">
                <i class="bi bi-heart-pulse-fill text-danger" style="font-size: 4rem;"></i>
                <h1 class="display-5 fw-bold mt-2">My Valentine</h1>
                <p class="lead mb-4 text-muted">‡πÄ‡∏ã‡∏≠‡∏£‡πå‡πÑ‡∏û‡∏£‡∏™‡πå‡πÄ‡∏•‡πá‡∏Å‡πÜ ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏ò‡∏≠</p>
                <button class="btn btn-main btn-lg" onclick="playSound(); goToPage('page-passcode')">
                    ‡πÅ‡∏ï‡∏∞‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏£‡∏¥‡πà‡∏° <i class="bi bi-arrow-right-short"></i>
                </button>
            </div>
        </div>
    </section>

    <section id="page-passcode" class="section-page">
        <div class="container h-100 d-flex justify-content-center align-items-center" style="min-height: 80vh;">
            <div class="glass-card text-center" style="max-width: 400px; width: 100%;">
                <h3 class="mb-4 fw-bold text-secondary">‡πÉ‡∏™‡πà‡∏£‡∏´‡∏±‡∏™‡∏ß‡∏±‡∏ô‡∏Ñ‡∏£‡∏ö‡∏£‡∏≠‡∏ö</h3>
                <div class="pin-dot-container" id="pinDots">
                    <div class="pin-dot"></div><div class="pin-dot"></div><div class="pin-dot"></div>
                    <div class="pin-dot"></div><div class="pin-dot"></div><div class="pin-dot"></div>
                </div>
                <div class="pin-grid">
                    <button class="pin-btn" onclick="enterPin(1)">1</button><button class="pin-btn" onclick="enterPin(2)">2</button><button class="pin-btn" onclick="enterPin(3)">3</button>
                    <button class="pin-btn" onclick="enterPin(4)">4</button><button class="pin-btn" onclick="enterPin(5)">5</button><button class="pin-btn" onclick="enterPin(6)">6</button>
                    <button class="pin-btn" onclick="enterPin(7)">7</button><button class="pin-btn" onclick="enterPin(8)">8</button><button class="pin-btn" onclick="enterPin(9)">9</button>
                    <div style="width: 75px;"></div><button class="pin-btn" onclick="enterPin(0)">0</button><button class="pin-btn text-danger" onclick="deletePin()"><i class="bi bi-backspace"></i></button>
                </div>
                <div id="error-msg" class="text-danger mt-3 d-none fw-bold bg-white rounded p-1 shadow-sm">‡∏£‡∏´‡∏±‡∏™‡∏ú‡∏¥‡∏î‡∏ô‡∏∞‡∏à‡πä‡∏∞ ‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà!</div>
            </div>
        </div>
    </section>

    <section id="page-menu" class="section-page">
        <div class="container">
            <div class="text-center mb-5 glass-card py-3">
                <h2 class="fw-bold mb-0">Our Journey</h2>
                <small class="text-muted">‡∏£‡∏ß‡∏°‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏£‡∏≤‡∏ß‡∏Ç‡∏≠‡∏á‡πÄ‡∏£‡∏≤ ‚ù§Ô∏è</small>
            </div>
            <div class="menu-grid">
                <div class="menu-item" onclick="playSound(); goToPage('page-memory')"><i class="bi bi-images"></i><span>‡∏£‡∏π‡∏õ‡∏Ç‡∏≠‡∏á‡πÄ‡∏£‡∏≤</span></div>
                <div class="menu-item" onclick="playSound(); goToPage('page-timer')"><i class="bi bi-hourglass-split"></i><span>‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà‡∏Ñ‡∏ö</span></div>
                <div class="menu-item" onclick="playSound(); goToPage('page-letter')"><i class="bi bi-envelope-heart"></i><span>‡∏à‡∏î‡∏´‡∏°‡∏≤‡∏¢</span></div>
                <div class="menu-item" onclick="playSound(); goToPage('page-music')"><i class="bi bi-music-note-beamed"></i><span>‡πÄ‡∏û‡∏•‡∏á</span></div>
                <div class="menu-item" onclick="playSound(); goToPage('page-quiz')"><i class="bi bi-patch-question"></i><span>‡∏ó‡∏≤‡∏¢‡πÉ‡∏à</span></div>
                <div class="menu-item" onclick="playSound(); goToPage('page-coupon')"><i class="bi bi-ticket-perforated"></i><span>‡∏Ñ‡∏π‡∏õ‡∏≠‡∏á</span></div>
                <div class="menu-item" onclick="playSound(); goToPage('page-reasons')"><i class="bi bi-heart-fill"></i><span>‡πÄ‡∏´‡∏ï‡∏∏‡∏ú‡∏•‡∏ó‡∏µ‡πà‡∏£‡∏±‡∏Å</span></div>
                <div class="menu-item" onclick="playSound(); goToPage('page-date')"><i class="bi bi-calendar-heart"></i><span>‡πÄ‡∏î‡∏ó‡∏ñ‡∏±‡∏î‡πÑ‡∏õ</span></div>
                <div class="menu-item" onclick="playSound(); goToPage('page-memories')"><i class="bi bi-journal-bookmark-fill"></i><span>‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡∏£‡∏á‡∏à‡∏≥</span></div>
            </div>
        </div>
    </section>

    <section id="page-memory" class="section-page">
        <div class="container">
            <div class="text-center mb-3">
                <h3 class="text-white fw-bold" style="text-shadow: 0 2px 4px rgba(0,0,0,0.2);">üì∏ Our Sweet Memories</h3>
            </div>
            <div class="polaroid-frame">
                <div id="memCarousel" class="carousel slide" data-bs-ride="carousel">
                    <div class="carousel-inner" id="gallery-container">
                        <div class="carousel-item active">
                            <div class="d-flex justify-content-center align-items-center bg-light" style="min-height: 400px; padding: 15px;">
                                <div class="text-muted">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏†‡∏≤‡∏û‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡∏£‡∏á‡∏à‡∏≥...</div>
                            </div>
                        </div>
                    </div>
                    
                    <button class="carousel-control-prev" type="button" data-bs-target="#memCarousel" data-bs-slide="prev" onclick="playSound()">
                        <span class="carousel-control-prev-icon filter-black"></span>
                    </button>
                    <button class="carousel-control-next" type="button" data-bs-target="#memCarousel" data-bs-slide="next" onclick="playSound()">
                        <span class="carousel-control-next-icon filter-black"></span>
                    </button>
                </div>
            </div>
        </div>
    </section>

    <section id="page-coupon" class="section-page">
        <div class="container text-center h-100 d-flex flex-column justify-content-center align-items-center">
            <h2 class="fw-bold text-white mb-3" style="text-shadow: 0 2px 5px rgba(0,0,0,0.2);">Love Coupons üé∞</h2>
            <div id="coupon-display" class="d-none w-100">
                <div class="coupon-ticket bg-white mx-auto">
                    <div class="coupon-inner">
                        <h1 class="display-1 mb-0">üéÅ</h1>
                        <h3 class="fw-bold text-danger mt-3" id="coupon-text">...</h3>
                        <small class="text-muted d-block mt-2">*‡πÅ‡∏Ñ‡∏õ‡∏à‡∏≠‡∏ô‡∏µ‡πâ‡∏°‡∏≤‡πÉ‡∏ä‡πâ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢*</small>
                    </div>
                </div>
            </div>
            <button id="btn-spin" class="btn btn-warning btn-lg rounded-pill px-5 fw-bold shadow mt-4" style="font-size: 1.5rem;" onclick="spinCoupon()"><i class="bi bi-stars"></i> ‡∏™‡∏∏‡πà‡∏°‡πÄ‡∏•‡∏¢!</button>
        </div>
    </section>

    <section id="page-quiz" class="section-page">
        <div class="container">
            <div class="glass-card col-md-8 mx-auto" style="min-height: 400px;">
                <h3 class="text-center mb-4 fw-bold text-primary">‡πÅ‡∏ü‡∏ô‡∏û‡∏±‡∏ô‡∏ò‡∏∏‡πå‡πÅ‡∏ó‡πâ üßê</h3>
                <div id="quiz-container"></div>
                <div id="quiz-result" class="text-center d-none mt-5">
                    <h1 class="display-4">üéâ</h1>
                    <h3>‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì: <span id="score-val" class="text-danger fw-bold"></span>/5</h3>
                    <p id="score-msg" class="lead"></p>
                    <button class="btn btn-main mt-4" onclick="playSound(); resetQuiz()">‡πÄ‡∏•‡πà‡∏ô‡πÉ‡∏´‡∏°‡πà</button>
                </div>
            </div>
        </div>
    </section>

    <section id="page-timer" class="section-page">
        <div class="container text-center d-flex flex-column justify-content-center h-100">
            <div class="glass-card py-5">
                <i class="bi bi-heart-fill text-danger fs-1 mb-3"></i>
                <h2 class="fw-bold text-danger">Together For</h2>
                <div class="mt-4 row justify-content-center g-2 px-2">
                    <div class="col-auto"><div class="time-box"><div id="t-years" class="time-val">0</div><div>Years</div></div></div>
                    <div class="col-auto"><div class="time-box"><div id="t-days" class="time-val">0</div><div>Days</div></div></div>
                    <div class="col-auto"><div class="time-box"><div id="t-hours" class="time-val">0</div><div>Hours</div></div></div>
                    <div class="col-auto"><div class="time-box"><div id="t-mins" class="time-val">0</div><div>Mins</div></div></div>
                    <div class="col-auto"><div class="time-box"><div id="t-secs" class="time-val">0</div><div>Secs</div></div></div>
                </div>
                <p class="mt-5 text-muted small">‡∏ô‡∏±‡∏ö‡∏ï‡∏±‡πâ‡∏á‡πÅ‡∏ï‡πà 16 ‡∏°.‡∏Ñ. 2569</p>
            </div>
        </div>
    </section>

    <section id="page-letter" class="section-page">
        <div class="container">
            <div class="glass-card">
                <div class="letter-paper">
                    <p id="typewriter-text" style="white-space: pre-wrap; font-size: 1.1rem;"></p>
                </div>
                <div class="text-center mt-3"><small class="text-muted">‡∏£‡∏±‡∏Å‡πÄ‡∏™‡∏°‡∏≠ :)</small></div>
            </div>
        </div>
    </section>

    <section id="page-music" class="section-page">
        <div class="container text-center h-100 d-flex flex-column justify-content-center">
            <div class="glass-card col-md-6 mx-auto py-5">
                <h2 class="mb-4">Our Song üéµ</h2>
                <div class="vinyl-record" id="vinyl"><div class="vinyl-inner"></div></div>
                <p class="mb-3">‡πÄ‡∏û‡∏•‡∏á‡∏ô‡∏µ‡πâ‡∏°‡∏≠‡∏ö‡πÉ‡∏´‡πâ‡πÄ‡∏ò‡∏≠‡∏ô‡∏∞...</p>
                <audio id="audioPlayer" controls class="w-100 mt-3"><source src="images/music.mp3" type="audio/mpeg"></audio>
            </div>
        </div>
    </section>

    <section id="page-reasons" class="section-page">
        <div class="d-flex flex-column justify-content-center align-items-center h-100 text-center">
            <div class="glass-card p-5" onclick="randReason()">
                <i class="bi bi-heart-fill text-danger display-1 mb-3"></i>
                <h3 class="fw-bold">‡πÄ‡∏´‡∏ï‡∏∏‡∏ú‡∏•‡∏ó‡∏µ‡πà‡∏£‡∏±‡∏Å‡πÄ‡∏ò‡∏≠</h3>
                <h4 id="reason-txt" class="text-primary mt-4 fw-bold">...</h4>
            </div>
        </div>
    </section>

    <section id="page-date" class="section-page">
        <div class="d-flex flex-column justify-content-center align-items-center h-100 text-center">
            <div class="glass-card p-5">
                <h3 class="fw-bold mb-4">‡πÄ‡∏î‡∏ó‡∏ñ‡∏±‡∏î‡πÑ‡∏õ‡∏ó‡∏≥‡πÑ‡∏£‡∏î‡∏µ? üìÖ</h3>
                <h2 id="date-txt" class="fw-bold text-danger">???</h2>
                <button class="btn-main mt-4" onclick="randDate()">‡∏™‡∏∏‡πà‡∏°‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà</button>
            </div>
        </div>
    </section>

    <section id="page-memories" class="section-page">
        <div class="d-flex flex-column justify-content-center align-items-center h-100 text-center">
            <div class="glass-card p-4" style="max-width: 85%;" onclick="randMemory()">
                <i class="bi bi-stars text-warning fs-1 mb-3"></i>
                <h3 class="fw-bold mb-3">‡∏Å‡∏•‡πà‡∏≠‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡∏£‡∏á‡∏à‡∏≥ üí≠</h3>
                <h5 id="memo-txt" class="text-primary mt-4 fw-bold" style="font-family: 'Mali', cursive;">"‡∏Å‡∏î‡∏™‡∏¥... ‡∏≠‡∏¢‡∏≤‡∏Å‡πÄ‡∏•‡πà‡∏≤‡∏≠‡∏∞‡πÑ‡∏£‡πÉ‡∏´‡πâ‡∏ü‡∏±‡∏á"</h5>
            </div>
        </div>
    </section>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        const CONFIG = {
            passcode: "160169", 
            startDate: "2026-01-16", 
            letterMessage: `‡∏ñ‡∏∂‡∏á... ‡∏Ñ‡∏ô‡∏î‡∏µ‡∏Ç‡∏≠‡∏á‡πÄ‡∏Ñ‡πâ‡∏≤\n\n‡∏™‡∏∏‡∏Ç‡∏™‡∏±‡∏ô‡∏ï‡πå‡∏ß‡∏±‡∏ô‡∏ß‡∏≤‡πÄ‡∏•‡∏ô‡πÑ‡∏ó‡∏ô‡πå‡∏ô‡∏∞! \n‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏ó‡∏µ‡πà‡πÄ‡∏Ç‡πâ‡∏≤‡∏°‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏£‡∏≤‡∏ß‡∏î‡∏µ‡πÜ ‡πÉ‡∏ô‡∏ä‡∏µ‡∏ß‡∏¥‡∏ï‡πÄ‡∏Ñ‡πâ‡∏≤‡∏ô‡∏∞\n‡∏Ç‡∏≠‡πÉ‡∏´‡πâ‡πÄ‡∏£‡∏≤‡πÑ‡∏î‡πâ‡∏â‡∏•‡∏≠‡∏á‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡∏î‡πâ‡∏ß‡∏¢‡∏Å‡∏±‡∏ô‡πÑ‡∏õ‡∏≠‡∏µ‡∏Å‡∏ô‡∏≤‡∏ô‡πÜ ‡πÄ‡∏•‡∏¢\n‡∏£‡∏±‡∏Å‡πÄ‡∏ò‡∏≠‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î‡πÉ‡∏ô‡πÇ‡∏•‡∏Å ‚ù§Ô∏è\n\n‡∏à‡∏≤‡∏Å... ‡πÄ‡∏Ñ‡πâ‡∏≤‡πÄ‡∏≠‡∏á`,
            quizData: [
                { q: "‡πÄ‡∏£‡∏≤‡πÄ‡∏à‡∏≠‡∏Å‡∏±‡∏ô‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÅ‡∏£‡∏Å‡∏ó‡∏µ‡πà‡πÑ‡∏´‡∏ô?", options: ["‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô", "‡∏´‡πâ‡∏≤‡∏á", "‡∏£‡πâ‡∏≤‡∏ô‡∏Å‡∏≤‡πÅ‡∏ü", "‡πÉ‡∏ô‡πÅ‡∏ä‡∏ó"], ans: 0 },
                { q: "‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏ó‡∏µ‡πà‡πÅ‡∏ü‡∏ô‡∏ä‡∏≠‡∏ö‡∏Å‡∏¥‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î?", options: ["‡∏ä‡∏≤‡∏ö‡∏π", "‡∏ã‡∏π‡∏ä‡∏¥", "‡∏™‡πâ‡∏°‡∏ï‡∏≥", "‡∏Ç‡πâ‡∏≤‡∏ß‡∏°‡∏±‡∏ô‡πÑ‡∏Å‡πà"], ans: 0 },
                { q: "‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏≤‡∏ï‡∏Å‡∏•‡∏á‡πÄ‡∏õ‡πá‡∏ô‡πÅ‡∏ü‡∏ô‡∏Å‡∏±‡∏ô?", options: ["14 ‡∏Å‡∏∏‡∏°‡∏†‡∏≤", "1 ‡∏°‡∏Å‡∏£‡∏≤", "25 ‡∏ò‡∏±‡∏ô‡∏ß‡∏≤", "‡∏ß‡∏±‡∏ô‡∏•‡∏≠‡∏¢‡∏Å‡∏£‡∏∞‡∏ó‡∏á"], ans: 0 },
                { q: "‡πÄ‡∏£‡∏≤‡∏ä‡∏≠‡∏ö‡∏ó‡∏∞‡πÄ‡∏•‡∏´‡∏£‡∏∑‡∏≠‡∏†‡∏π‡πÄ‡∏Ç‡∏≤‡∏°‡∏≤‡∏Å‡∏Å‡∏ß‡πà‡∏≤‡∏Å‡∏±‡∏ô?", options: ["‡∏ó‡∏∞‡πÄ‡∏•", "‡∏†‡∏π‡πÄ‡∏Ç‡∏≤"], ans: 1 },
                { q: "‡∏Ñ‡∏≥‡∏û‡∏π‡∏î‡∏ï‡∏¥‡∏î‡∏õ‡∏≤‡∏Å‡∏Ç‡∏≠‡∏á‡πÄ‡∏Ñ‡πâ‡∏≤‡∏Ñ‡∏∑‡∏≠?", options: ["‡∏´‡∏¥‡∏ß‡∏Ç‡πâ‡∏≤‡∏ß", "‡∏á‡πà‡∏ß‡∏á‡∏ô‡∏≠‡∏ô", "‡∏Ñ‡∏¥‡∏î‡∏ñ‡∏∂‡∏á", "‡∏ö‡πà‡∏ô‡πÑ‡∏£‡∏≠‡∏∞"], ans: 0 }
            ],
            coupons: ["‡∏ô‡∏ß‡∏î‡∏ü‡∏£‡∏µ 30 ‡∏ô‡∏≤‡∏ó‡∏µ üíÜ‚Äç‚ôÄÔ∏è", "‡∏ï‡∏≤‡∏°‡πÉ‡∏à 1 ‡∏ß‡∏±‡∏ô üëë", "‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á‡∏Ç‡πâ‡∏≤‡∏ß 1 ‡∏°‡∏∑‡πâ‡∏≠ üç≤", "‡∏´‡πâ‡∏≤‡∏°‡∏á‡∏≠‡∏ô 1 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á ü•∫", "‡∏à‡∏∏‡πä‡∏ö 10 ‡∏ó‡∏µ üòò"],
            reasons: ["‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡πÄ‡∏ò‡∏≠‡∏Ñ‡∏∑‡∏≠‡∏£‡∏≠‡∏¢‡∏¢‡∏¥‡πâ‡∏°‡∏Ç‡∏≠‡∏á‡πÄ‡∏Ñ‡πâ‡∏≤", "‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡πÄ‡∏ò‡∏≠‡∏ó‡∏≥‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏≠‡∏£‡πà‡∏≠‡∏¢", "‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡πÄ‡∏ò‡∏≠‡∏Ñ‡∏≠‡∏¢‡∏£‡∏±‡∏ö‡∏ü‡∏±‡∏á‡πÄ‡∏™‡∏°‡∏≠", "‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡πÄ‡∏ò‡∏≠‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡∏±‡∏ß‡∏Ç‡∏≠‡∏á‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á", "‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡πÄ‡∏ò‡∏≠‡∏Ç‡∏µ‡πâ‡∏≠‡πâ‡∏≠‡∏ô‡∏ô‡πà‡∏≤‡∏£‡∏±‡∏Å"],
            dates: ["‡∏î‡∏π‡∏´‡∏ô‡∏±‡∏á‡∏£‡∏≠‡∏ö‡∏î‡∏∂‡∏Å üçø", "‡πÑ‡∏õ‡∏õ‡∏¥‡∏Ñ‡∏ô‡∏¥‡∏Ñ‡∏ó‡∏µ‡πà‡∏™‡∏ß‡∏ô üå≥", "‡∏Å‡∏¥‡∏ô‡∏ö‡∏∏‡∏ü‡πÄ‡∏ü‡∏ï‡πå‡∏à‡∏∏‡∏Å‡πÜ ü•©", "‡∏Ç‡∏±‡∏ö‡∏£‡∏ñ‡πÄ‡∏•‡πà‡∏ô‡∏î‡∏π‡∏ß‡∏¥‡∏ß üöó", "‡∏ó‡∏≥‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏Å‡∏¥‡∏ô‡∏Å‡∏±‡∏ô‡πÄ‡∏≠‡∏á üç≥"],
            memories: [
                "‡∏à‡∏≥‡∏ß‡∏±‡∏ô‡πÅ‡∏£‡∏Å‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏≤‡∏Ñ‡∏∏‡∏¢‡∏Å‡∏±‡∏ô‡πÑ‡∏î‡πâ‡πÑ‡∏´‡∏°? ‡∏ï‡∏≠‡∏ô‡∏ô‡∏±‡πâ‡∏ô‡πÄ‡∏Ç‡∏¥‡∏ô‡∏°‡∏≤‡∏Å‡πÄ‡∏•‡∏¢‡∏ô‡∏∞ ‡πÑ‡∏°‡πà‡∏Ñ‡∏¥‡∏î‡∏ß‡πà‡∏≤‡∏à‡∏∞‡∏£‡∏±‡∏Å‡πÄ‡∏ò‡∏≠‡πÑ‡∏î‡πâ‡∏Ç‡∏ô‡∏≤‡∏î‡∏ô‡∏µ‡πâ",
                "‡πÄ‡∏î‡∏ó‡πÅ‡∏£‡∏Å‡∏ó‡∏µ‡πà‡πÑ‡∏õ‡πÄ‡∏ó‡∏µ‡πà‡∏¢‡∏ß‡∏î‡πâ‡∏ß‡∏¢‡∏Å‡∏±‡∏ô ‡πÄ‡∏ò‡∏≠‡πÅ‡∏ï‡πà‡∏á‡∏ï‡∏±‡∏ß‡∏ô‡πà‡∏≤‡∏£‡∏±‡∏Å‡∏°‡∏≤‡∏Å ‡∏à‡∏ô‡πÄ‡∏£‡∏≤‡πÑ‡∏°‡πà‡∏Å‡∏•‡πâ‡∏≤‡∏°‡∏≠‡∏á‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏•‡∏¢",
                "‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏ó‡∏µ‡πà‡∏ï‡∏∑‡πà‡∏ô‡∏°‡∏≤‡πÅ‡∏•‡πâ‡∏ß‡∏£‡∏π‡πâ‡∏ß‡πà‡∏≤‡∏°‡∏µ‡πÄ‡∏ò‡∏≠‡∏≠‡∏¢‡∏π‡πà‡∏Ç‡πâ‡∏≤‡∏á‡πÜ ‡∏Ñ‡∏∑‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡∏£‡∏á‡∏à‡∏≥‡∏ó‡∏µ‡πà‡∏î‡∏µ‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î‡πÉ‡∏ô‡∏ó‡∏∏‡∏Å‡πÜ ‡∏ß‡∏±‡∏ô‡∏Ç‡∏≠‡∏á‡πÄ‡∏Ñ‡πâ‡∏≤‡πÄ‡∏•‡∏¢"
            ],
            // --- ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Gallery ‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ ---
            gallery: {
                path: 'images/', // ‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡πá‡∏ö‡∏£‡∏π‡∏õ
                maxFileIndex: 127     // pic0 ‡∏ñ‡∏∂‡∏á pic127
            }
        };

        function playSound() {
            const ctx = new (window.AudioContext || window.webkitAudioContext)();
            const osc = ctx.createOscillator(); const gain = ctx.createGain();
            osc.frequency.setValueAtTime(600, ctx.currentTime);
            osc.frequency.exponentialRampToValueAtTime(300, ctx.currentTime + 0.1);
            gain.gain.setValueAtTime(0.1, ctx.currentTime);
            gain.gain.exponentialRampToValueAtTime(0.01, ctx.currentTime + 0.1);
            osc.connect(gain); gain.connect(ctx.destination);
            osc.start(); osc.stop(ctx.currentTime + 0.1);
        }

        function goToPage(pageId) {
            document.querySelectorAll('.section-page').forEach(el => el.classList.remove('active-section'));
            document.getElementById(pageId).classList.add('active-section');
            window.scrollTo(0, 0);
            const backBtn = document.getElementById('backBtn');
            if(['page-landing', 'page-passcode', 'page-menu'].includes(pageId)) backBtn.classList.add('hidden');
            else backBtn.classList.remove('hidden');
            if(pageId === 'page-letter') startTypewriter();
            if(pageId === 'page-quiz') loadQuizStep(0);
            if(pageId === 'page-timer') updateTimer();
            if(pageId !== 'page-music') {
                const vinyl = document.getElementById('vinyl');
                if(vinyl) vinyl.classList.remove('spinning');
            }
        }

        // --- Gallery Logic (New) ---
        function initGallery() {
            const container = document.getElementById('gallery-container');
            container.innerHTML = ''; // Clear loading state
            
            const max = CONFIG.gallery.maxFileIndex;
            let hasAddedActive = false;

            for(let i = 0; i <= max; i++) {
                // 1. Create wrapper div
                const slide = document.createElement('div');
                slide.className = 'carousel-item';
                
                // 2. Create Image element first
                const img = document.createElement('img');
                img.src = `${CONFIG.gallery.path}pic${i}.jpg`;
                img.className = 'd-block polaroid-img';
                
                // Caption
                const caption = document.createElement('div');
                caption.className = 'polaroid-caption';
                caption.innerText = `Memory #${i}`;

                // 3. Handle Error (If JPG not found, try MP4)
                img.onerror = function() {
                    this.remove(); // Remove broken image
                    
                    const vid = document.createElement('video');
                    vid.src = `${CONFIG.gallery.path}pic${i}.mp4`;
                    vid.className = 'd-block polaroid-img';
                    vid.loop = true;
                    vid.autoplay = true;
                    vid.muted = true;
                    vid.playsInline = true;

                    // If Video also not found -> Remove entire slide
                    vid.onerror = function() {
                        slide.remove();
                        checkActiveSlide(); // Re-check active status
                    };

                    slide.insertBefore(vid, caption);
                };

                // Add to DOM
                slide.appendChild(img);
                slide.appendChild(caption);
                container.appendChild(slide);
            }

            // Set first item active after short delay
            setTimeout(checkActiveSlide, 500);
        }

        function checkActiveSlide() {
            const slides = document.querySelectorAll('#gallery-container .carousel-item');
            if (slides.length > 0) {
                let hasActive = false;
                slides.forEach(s => { if(s.classList.contains('active')) hasActive = true; });
                if (!hasActive) slides[0].classList.add('active');
            }
        }
        
        // Initialize Gallery on Load
        window.onload = function() {
            createHearts();
            initGallery();
        };

        // --- Other Logic ---
        let currentPin = "";
        function enterPin(num) {
            playSound();
            if(currentPin.length < 6) {
                currentPin += num; updateDots();
                if(currentPin.length === 6) {
                    if(currentPin === CONFIG.passcode) setTimeout(() => goToPage('page-menu'), 200);
                    else { document.getElementById('error-msg').classList.remove('d-none'); currentPin = ""; setTimeout(updateDots, 600); }
                }
            }
        }
        function deletePin() { playSound(); currentPin = currentPin.slice(0, -1); updateDots(); document.getElementById('error-msg').classList.add('d-none'); }
        function updateDots() { document.querySelectorAll('.pin-dot').forEach((dot, index) => { dot.classList.toggle('filled', index < currentPin.length); }); }

        function spinCoupon() {
            playSound(); const btn = document.getElementById('btn-spin'); const display = document.getElementById('coupon-display'); const text = document.getElementById('coupon-text');
            btn.disabled = true; btn.innerHTML = '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡∏∏‡πà‡∏°...'; display.classList.add('d-none');
            setTimeout(() => {
                const result = CONFIG.coupons[Math.floor(Math.random() * CONFIG.coupons.length)];
                text.innerText = result; display.classList.remove('d-none'); btn.innerHTML = '‡∏™‡∏∏‡πà‡∏°‡πÉ‡∏´‡∏°‡πà'; btn.disabled = false;
            }, 1000);
        }
        function randReason() { playSound(); document.getElementById('reason-txt').innerText = CONFIG.reasons[Math.floor(Math.random()*CONFIG.reasons.length)]; }
        function randDate() { playSound(); document.getElementById('date-txt').innerText = CONFIG.dates[Math.floor(Math.random()*CONFIG.dates.length)]; }
        function randMemory() { playSound(); document.getElementById('memo-txt').innerText = CONFIG.memories[Math.floor(Math.random()*CONFIG.memories.length)]; }

        let currentQIndex = 0; let quizScore = 0;
        function loadQuizStep(index) {
            currentQIndex = index; const container = document.getElementById('quiz-container'); const resultDiv = document.getElementById('quiz-result');
            if(index === 0) { quizScore = 0; resultDiv.classList.add('d-none'); container.innerHTML = ''; }
            if(index >= CONFIG.quizData.length) { showQuizResult(); return; }
            const item = CONFIG.quizData[index];
            let optionsHTML = ""; item.options.forEach((opt, optIdx) => { optionsHTML += `<button class="quiz-opt" onclick="checkAnswerStep(this, ${index}, ${optIdx})">${opt}</button>`; });
            container.innerHTML = `<div class="quiz-step active"><h4 class="mb-4 fw-bold">${item.q}</h4><div class="d-flex flex-column">${optionsHTML}</div></div>`;
        }
        function checkAnswerStep(btn, qIndex, optIndex) {
            playSound(); const correctAns = CONFIG.quizData[qIndex].ans; const allBtns = document.querySelectorAll('.quiz-opt'); allBtns.forEach(b => b.disabled = true);
            if(optIndex === correctAns) { btn.classList.add('correct'); quizScore++; } else { btn.classList.add('wrong'); allBtns[correctAns].classList.add('correct'); }
            setTimeout(() => { loadQuizStep(qIndex + 1); }, 1000);
        }
        function showQuizResult() { document.getElementById('quiz-container').innerHTML = ''; document.getElementById('quiz-result').classList.remove('d-none'); document.getElementById('score-val').innerText = quizScore; document.getElementById('score-msg').innerText = quizScore === 5 ? "‡∏™‡∏∏‡∏î‡∏¢‡∏≠‡∏î! ‡πÅ‡∏ü‡∏ô‡∏û‡∏±‡∏ô‡∏ò‡∏∏‡πå‡πÅ‡∏ó‡πâ üíñ" : "‡πÄ‡∏Å‡πà‡∏á‡∏°‡∏≤‡∏Å‡∏à‡πâ‡∏≤ ü•∞"; }
        function resetQuiz() { loadQuizStep(0); }

        function updateTimer() {
            const start = new Date(CONFIG.startDate).getTime();
            setInterval(() => {
                const now = new Date().getTime(); const diff = now - start;
                document.getElementById('t-years').innerText = Math.floor(Math.floor(diff / (1000 * 60 * 60 * 24)) / 365);
                document.getElementById('t-days').innerText = Math.floor(diff / (1000 * 60 * 60 * 24)) % 365;
                document.getElementById('t-hours').innerText = Math.floor((diff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
                document.getElementById('t-mins').innerText = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
                document.getElementById('t-secs').innerText = Math.floor((diff % (1000 * 60)) / 1000);
            }, 1000);
        }

        function createHearts() {
            const container = document.getElementById('heartsContainer');
            for(let i=0; i<15; i++) {
                const heart = document.createElement('div'); heart.classList.add('heart-float');
                heart.style.left = Math.random() * 100 + 'vw'; heart.style.animationDuration = (Math.random() * 5 + 5) + 's';
                container.appendChild(heart);
            }
        }

        let typed = false;
        function startTypewriter() {
            if(typed) return;
            const textEl = document.getElementById('typewriter-text'); const text = CONFIG.letterMessage; textEl.innerHTML = "";
            let i = 0; function type() { if (i < text.length) { textEl.innerHTML += text.charAt(i); i++; setTimeout(type, 50); } } type(); typed = true;
        }

        const audio = document.getElementById('audioPlayer'); const vinyl = document.getElementById('vinyl');
        audio.onplay = () => vinyl.classList.add('spinning'); audio.onpause = () => vinyl.classList.remove('spinning');
    </script>
</body>
</html>